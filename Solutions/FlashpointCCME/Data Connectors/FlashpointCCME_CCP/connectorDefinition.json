{
    "type": "Microsoft.SecurityInsights/dataConnectorDefinitions",
    "apiVersion": "2022-09-01-preview",
    "name": "FlashpointCCME_CCP",
    "location": "{{location}}",
    "kind": "Customizable",
    "properties": {
        "connectorUiConfig": {
            "id": "FlashpointCCME_CCP",
            "title": "Flashpoint CCM-E",
            "publisher": "Flashpoint",
            "descriptionMarkdown": "CCM-E Data from Flashpoint",
            "graphQueriesTableName": "CCME4_CL",
            "graphQueries": [
                {
                    "metricName": "Events",
                    "legend": "Events",
                    "baseQuery": "CCME4_CL"
                }
            ],
            "sampleQueries": [
                {
                    "description": "Get sample of CCME data",
                    "query": "{{graphQueriesTableName}}\n | take 10"
                }
            ],
            "dataTypes": [
                {
                    "name": "CCME4_CL",
                    "lastDataReceivedQuery": "CCME4_CL\n | where TimeGenerated > ago(7d) | summarize Time = max(TimeGenerated)\n | where isnotempty(Time)"
                }
            ],
            "connectivityCriteria": [
                {
                    "type": "HasDataConnectors"
                }
            ],
            "availability": {
                "isPreview": false
            },
            "permissions": {
                "resourceProvider": [
                    {
                        "provider": "Microsoft.OperationalInsights/workspaces",
                        "permissionsDisplayText": "Read and Write permissions are required.",
                        "providerDisplayName": "Workspace",
                        "scope": "Workspace",
                        "requiredPermissions": {
                            "write": true,
                            "read": true,
                            "delete": true
                        }
                    }
                ],
                "customs": [
                    {
                        "name": "Flashpoint API token",
                        "description": "A Flaspoint API Token is required. See Docs."
                    }
                ]
            },
            "instructionSteps": [
                {
                    "title": "Enter Flashpoint Details",
                    "description": "Enter details for the Flashpoint CCM-E data connector",
                    "instructions": [
                        {
                            "type": "Textbox",
                            "parameters": {
                                "label": "API Key",
                                "placeholder": "Enter your API Token",
                                "type": "password",
                                "name": "ApiKey"
                            }
                        },
                        {
                            "type": "Textbox",
                            "parameters": {
                                "label": "Password Complexity Length",
                                "placeholder": "Enter length (e.g., 8, >10, >=12, <16) or * for all lengths",
                                "type": "text",
                                "name": "PasswordComplexityLength"
                            }
                        },
                        {
                            "type": "Dropdown",
                            "parameters": {
                                "label": "Password Has Lowercase",
                                "type": "text",
                                "name": "PasswordHasLowercase",
                                "required": true,
                                "placeholder": "Select a filter",
                                "options": [
                                    {
                                        "key": "*",
                                        "text": "All passwords regardless of case"
                                    },
                                    {
                                        "key": "true",
                                        "text": "Only passwords containing at least one lowercase letter"
                                    },
                                    {
                                        "key": "false",
                                        "text": "Only passwords containing no lowercase letters"
                                    }
                                ]
                            }
                        },
                        {
                            "type": "Dropdown",
                            "parameters": {
                                "label": "Password Has Uppercase",
                                "type": "text",
                                "name": "PasswordHasUppercase",
                                "required": true,
                                "placeholder": "Select a filter",
                                "options": [
                                    {
                                        "key": "*",
                                        "text": "All passwords regardless of case"
                                    },
                                    {
                                        "key": "true",
                                        "text": "Only passwords containing at least one uppercase letter"
                                    },
                                    {
                                        "key": "false",
                                        "text": "Only passwords containing no uppercase letters"
                                    }
                                ]
                            }
                        },
                        {
                            "type": "Dropdown",
                            "parameters": {
                                "label": "Password Has Number",
                                "type": "text",
                                "name": "PasswordHasNumber",
                                "required": true,
                                "placeholder": "Select a filter",
                                "options": [
                                    {
                                        "key": "*",
                                        "text": "All passwords regardless of containing numbers"
                                    },
                                    {
                                        "key": "true",
                                        "text": "Only passwords containing at least one number"
                                    },
                                    {
                                        "key": "false",
                                        "text": "Only passwords containing no numbers"
                                    }
                                ]
                            }
                        },
                        {
                            "type": "Dropdown",
                            "parameters": {
                                "label": "Password Has Symbol",
                                "type": "text",
                                "name": "PasswordHasSymbol",
                                "required": true,
                                "placeholder": "Select a data type",
                                "options": [
                                    {
                                        "key": "*",
                                        "text": "All passwords regardless of containing symbols"
                                    },
                                    {
                                        "key": "true",
                                        "text": "Only passwords containing at least one symbol"
                                    },
                                    {
                                        "key": "false",
                                        "text": "Only passwords containing no symbols"
                                    }
                                ]
                            }
                        },
                        {
                            "type": "ConnectionToggleButton",
                            "parameters": {
                                "connectLabel": "connect",
                                "name": "connect"
                            }
                        }
                    ]
                }
            ]
        }
    }
}