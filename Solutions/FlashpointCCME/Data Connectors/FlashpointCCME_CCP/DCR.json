{
    "name": "FlashpointCCME_DCR",
    "apiVersion": "2022-06-01",
    "type": "Microsoft.Insights/dataCollectionRules",
    "location": "{{location}}",
    "properties": {
      "dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
      "streamDeclarations": {
        "Custom-CCMEStreamInput": {
          "columns": [
            { "name": "_id", "type": "string" },
            { "name": "_source", "type": "dynamic" }
          ]
        }
      },
      "dataFlows": [
        {
          "streams": ["Custom-CCMEStreamInput"],
          "destinations": ["FlashpointCCMEDestination"],
          "transformKql": "source | extend TimeGenerated = todatetime(_source.breach.created_at.date-time), EventId = _id",
          "outputStream": "Custom-CCME_CL"
        }
      ],
      "destinations": {
        "logAnalytics": [
          {
            "workspaceResourceId": "{{workspaceResourceId}}",
            "name": "FlashpointCCMEDestination"
          }
        ]
      }
    }
  }
  