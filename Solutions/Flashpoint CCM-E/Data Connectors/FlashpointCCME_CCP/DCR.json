{
    "name": "FlashpointCCME_DCR",
    "apiVersion": "2022-06-01",
    "type": "Microsoft.Insights/dataCollectionRules",
    "location": "{{location}}",
    "properties": {
      "dataCollectionEndpointId": "{{dataCollectionEndpointId}}",
      "streamDeclarations": {
        "Custom-CCMEStreamInput": {
          "columns": [
            { "name": "_id", "type": "string" },
            { "name": "_source", "type": "dynamic" }
          ]
        }
      },
      "dataFlows": [
        {
          "streams": ["Custom-CCMEStreamInput"],
          "destinations": ["FlashpointCCMEDestination"],
          "transformKql": "source | project-rename EventId = _id, Source = _source | extend TimeGenerated = now(), Domain = tostring(Source.domain), Email = tostring(Source.email), TimesSeen = toint(Source.times_seen), BreachCreatedAt = todatetime(Source.breach.created_at[\"date-time\"]), BreachFirstObservedAt = todatetime(Source.breach.first_observed_at[\"date-time\"]), BreachSource = tostring(Source.breach.source), BreachTitle = tostring(Source.breach[\"title\"]), BreachVictim = tostring(Source.breach.victim)",
          "outputStream": "Custom-CCME5_CL"
        }
      ],
      "destinations": {
        "logAnalytics": [
          {
            "workspaceResourceId": "{{workspaceResourceId}}",
            "name": "FlashpointCCMEDestination"
          }
        ]
      }
    }
  }
  